```
## utils

### 상승추세변환 여부함수

#### 함수명: `detectTrendChange`

#### 목적
분봉 또는 일봉 데이터를 분석하여 20일 이동평균선의 기울기 변화를 감지하고, 추세 전환 여부를 판단합니다.

#### Input
- **candleData**: 분봉 또는 일봉 데이터 배열 (120개 row)
  - 각 row는 다음 속성을 포함:
    - `clos` (종가): string 또는 number
    - `xymd` (날짜): string (YYYYMMDD)
    - `xhms` (시간): string (HHMMSS) - 분봉의 경우

#### Output
추세 상태를 나타내는 문자열:
- `"상승전환"`: 과거 음수 기울기 → 현재 0 또는 양수 기울기
- `"하락전환"`: 과거 양수 기울기 → 현재 0 또는 음수 기울기
- `"상승"`: 지속적인 양수 기울기
- `"하락"`: 지속적인 음수 기울기
- `"유지"`: 기울기가 0에 가까운 상태

#### 내부 로직

1. **이동평균 계산**
   - 최근 120개 데이터에서 각 시점의 20일 이동평균을 계산
   - 이동평균 = 최근 20개 종가의 평균

2. **기울기 계산**
   - 각 시점의 이동평균 기울기 계산
   - 기울기 = (현재 이동평균 - 이전 이동평균) / 이전 이동평균 * 100 (%)
   - 최소 5개 이상의 기울기 데이터 확보

3. **추세 전환 감지**
   - 현재 기울기 (index 0)와 과거 기울기들 (index 1~4)을 비교
   - **상승전환 조건**:
     - 현재 기울기 >= 0
     - 과거 3~5개 기울기가 모두 음수
   - **하락전환 조건**:
     - 현재 기울기 <= 0
     - 과거 3~5개 기울기가 모두 양수
   - **상승 조건**:
     - 현재 기울기 > 임계값 (예: 0.01%)
     - 전환 조건 미충족
   - **하락 조건**:
     - 현재 기울기 < -임계값 (예: -0.01%)
     - 전환 조건 미충족
   - **유지 조건**:
     - 기울기가 -임계값 ~ +임계값 사이

#### 사용 예시

```typescript
import { detectTrendChange } from '@/utils/trendAnalysis';

// 한투 API에서 받은 분봉 데이터
const bunbongData = [
  { xymd: "20231127", xhms: "093000", clos: "189.70", ... },
  { xymd: "20231127", xhms: "092900", clos: "189.50", ... },
  // ... 120개
];

const trendStatus = detectTrendChange(bunbongData);
console.log(trendStatus); // "상승전환", "하락전환", "상승", "하락", "유지"
```

#### 파일 위치
- 구현 파일: `utils/trendAnalysis.ts`
- 문서 파일: `utils/GEMINI.md` (현재 파일)

#### 주의사항
- 데이터는 최신순 정렬 (index 0이 가장 최근)
- 최소 25개 이상의 데이터 필요 (20일 이동평균 + 기울기 계산)
- 종가(`clos`)가 문자열인 경우 숫자로 변환 필요
```